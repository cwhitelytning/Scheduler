# Scheduler

* Плагин разработан для выполнения задач по времени.
* Протестирован на версиях: 1.8.2, 1.8.3 и 1.9.0.

## Установка

* Распакуйте архив.
* Переместите **scheduler.inc** в раздел **includes**
* Скомпилируйте плагин и переместите в раздел **plugins**
* Создайте файл **scheduler.cfg** в разделе **configs**
* Зарегистрируйте скомпилированный плагин в файле **plugins.ini** (переместите его название в самый конец)

## Особенности

* Реализация основана на задачах, которые могут быть созданы с помощью команд в файле конфигурации или консоли сервера.
* Для него не нужно подключать дополнительные модули для хранения данных.
* Позволяет настраивать формат задаваемого времени, комбинируя компоненты времени.
* Не имеет ограничений по количеству создаваемых задач и добавляемых в них команд (кроме памяти).
* Удобный для пользователя исходный код позволяет вам расширять возможности плагина без каких-либо трудностей.
* Удаление задачи и входящих в нее команд, после выполнения.
* Умеет работать с переходами на следующий день.
* Гибкая настройка времени и длительности задачи:
  * Установка только начального времени выполнения.
  * Установка начала и конца выполнения.

## Команды

#### Новое задание

```c
scheduler_new_task "формат" "начальное время" ["длительность"]
```

Создает новое задание.

* Каждое новое задание переходит в режим редактирования для добавления команд. 
* Пока задача находится в режиме редактирования она недоступна для выполнения.
* Только одна задача может находится в режиме редактирования.

##### Формат

Указывает, какие компоненты времени будут использоваться (год - **%Y**, месяц - **%m**, день - **%d**, часы - **%H,** минуты - **%M**, секунды - **%S**). 

* Если используется несколько временных компонентов, они должны быть разделены двоеточием.
* Начальное время и продолжительность должны использовать одинаковое количество компонентов в соответствии с форматом.

##### Начальное время и длительность

Устанавливает время срабатывания и продолжительность выполнения задания.

* Время должно соответствовать заданному формату.

#### Выбрать задание

```c
scheduler_select_task "id"
```

Позволяет выбрать задачу для добавления или удаления команд.

#### Снять с выбора задание

```c
scheduler_unselect_task
```

Снимает выбранную задачу с режима редактирования.

#### Добавить команду

```c
scheduler_add_command "параметр1" "параметр2" ...
```

Добавляет новую команду.

* Длина команды ограничена значением, установленным в исходнике. По умолчанию он составляет 127 символов.

#### Удалить все задания

```c
scheduler_remove_all_tasks
```

Удаляет все существующие задания.

## Квары

```c
scheduler_check_delay 1.0
```

Задает интервал для проверки и выполнения задач в секундах.

* Минимальное значение **0.1**.

```c
scheduler_remove_task_after_executed true
```

* Удалять задание после выполнения (да или нет).

```c
scheduler_debug true
```

* Включает вывод специальных сообщений в журнале (**true** или **false**).

## Примеры

```c
// Как только часы, минуты и секунды совпадут с текущим временем
scheduler_new_task "%H:%M:%S" "18:00:00"

// Задача будет выполняться при каждом изменении карты до тех пор, пока текущее время находится в диапазоне времени
scheduler_new_task "%H:%M" "18:00" "08:00"

// Рабочий пример задачи
scheduler_new_task "%H" "18" "08"
scheduler_add_command "mp_startmoney" "850" 
scheduler_add_command "sv_restartround" "1"
scheduler_unselect_task
```

